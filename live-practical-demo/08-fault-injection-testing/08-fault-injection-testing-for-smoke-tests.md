# Fault Injection Testing for Smoke Tests

## 故障注入测试设计

### 1. 针对TC-001的故障注入测试：**FI-TC-001: 产品数据库为空时首页加载失败验证**

```
Given: Saleor平台已启动并运行在localhost:3000
  And: 产品数据库已被清空（执行数据库清理，删除所有products表数据）
  And: 首页依赖产品数据来渲染产品列表
When: 用户访问storefront首页
Then: 页面应加载失败或显示空产品列表
  And: 冒烟测试TC-001应该失败，因为无法找到预期的产品列表元素
```

**验证目标**: 确保TC-001能够检测到产品数据缺失导致的首页功能失效。

### 2. 针对TC-002的故障注入测试：**FI-TC-002: 产品详情API故障时产品页面加载失败验证**

```
Given: Saleor平台已启动，storefront首页正常加载
  And: 产品详情页的GraphQL查询被人为阻断（通过网络拦截或API mock返回错误）
  And: 产品列表页面可以正常显示产品卡片
When: 用户点击任意产品链接
Then: 产品详情页应无法加载产品信息或显示错误状态
  And: 冒烟测试TC-002应该失败，因为无法验证产品信息和价格显示
```

**验证目标**: 确保TC-002能够检测到产品详情数据获取失败导致的产品页面功能失效。

### 3. 针对TC-003的故障注入测试：**FI-TC-003: 购物车API故障时添加商品功能失败验证**

```
Given: 用户已在产品详情页，产品信息正常显示
  And: 添加购物车的GraphQL mutation被人为阻断（返回错误响应或超时）
  And: 产品规格选择功能正常工作
When: 用户选择产品规格（如"S"号）并点击"Add to Cart"按钮
Then: 添加购物车操作应该失败
  And: 购物车图标不应显示数量更新
  And: 冒烟测试TC-003应该失败，因为无法验证购物车状态更新
```

**验证目标**: 确保TC-003能够检测到购物车功能故障时添加商品操作的失效。

### 4. 针对TC-004的故障注入测试：**FI-TC-004: 购物车页面路由故障时页面访问失败验证**

```
Given: Saleor storefront应用正常运行
  And: 购物车页面路由被人为破坏（如删除/cart路由配置或返回404）
  And: 其他页面（如首页）仍可正常访问
When: 用户直接导航到购物车页面URL (/cart)
Then: 购物车页面应无法正常加载（显示404或错误页面）
  And: 冒烟测试TC-004应该失败，因为页面URL验证或基本元素验证会失败
```

**验证目标**: 确保TC-004能够检测到购物车页面路由或基础设施故障。

### 5. 针对TC-005的故障注入测试：**FI-TC-005: 结账页面权限验证故障时页面访问失败验证**

```
Given: Saleor storefront应用正常运行
  And: 结账页面的权限验证逻辑被人为破坏（如强制要求登录但不提供登录入口）
  And: 结账页面路由存在但功能受限
When: 用户直接导航到结账页面URL (/checkout)
Then: 结账页面应显示访问受限或功能不完整状态
  And: 冒烟测试TC-005应该失败，因为无法验证结账页面的基本加载状态
```

**验证目标**: 确保TC-005能够检测到结账页面权限或功能配置问题。

### 6. 针对TC-006的故障注入测试：**FI-TC-006: 页面间导航API故障时完整导航流程失败验证**

```
Given: Saleor storefront应用已启动
  And: 页面间导航的某个关键API端点被人为阻断（如产品详情API）
  And: 首页可以正常加载和显示
When: 用户按照完整导航流程操作（首页 → 产品页 → 购物车页 → 结账页 → 返回首页）
Then: 导航流程应在产品页加载步骤失败
  And: 冒烟测试TC-006应该失败，无法完成完整的导航验证序列
```

**验证目标**: 确保TC-006能够检测到关键导航路径中任何环节的故障。

### 7. 针对TC-007的故障注入测试：**FI-TC-007: 前端静态资源故障时UI元素加载失败验证**

```
Given: Saleor storefront应用已启动
  And: 关键CSS样式文件或JavaScript文件被人为破坏或阻断加载
  And: HTML页面可以正常返回但样式和交互功能缺失
When: 用户访问storefront首页
Then: 页面应显示布局混乱或导航元素不可见/不可用状态
  And: 冒烟测试TC-007应该失败，因为UI元素验证（如导航、页脚）会失败
```

**验证目标**: 确保TC-007能够检测到前端资源加载问题导致的UI功能降级。

## 执行建议

每个故障注入测试都专门针对对应冒烟测试所保护的核心功能：

1. **FI-TC-001**: 验证产品数据依赖检测能力
2. **FI-TC-002**: 验证产品详情API依赖检测能力  
3. **FI-TC-003**: 验证购物车功能依赖检测能力
4. **FI-TC-004**: 验证页面路由健康检测能力
5. **FI-TC-005**: 验证结账功能可访问性检测能力
6. **FI-TC-006**: 验证端到端导航流程健康检测能力
7. **FI-TC-007**: 验证前端基础设施健康检测能力

这些故障注入测试确保了每个冒烟测试都能有效检测其声明要保护的系统行为，验证了测试套件的有效性和可靠性。
